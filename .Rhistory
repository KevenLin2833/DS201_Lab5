top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% top5)
filterData
#liquorSale %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() + geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=),  stat="identity")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
#liquorSale %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() + geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=),  stat="identity")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() + geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=),  stat="identity")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() + geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity")
geom_line(liquorSale, aes(group=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity")
geom_line((liquorSale %>% group_by(Category.Name, Month) %>% summarise(total2 = sum(Bottles.Sold))), aes(group=Category.Name, x=Month, y = total2))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>% group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity") +
geom_line((liquorSale %>% group_by(Category.Name, Month) %>% summarise(total2 = sum(Bottles.Sold))), aes(group=Category.Name, x=Month, y = total2))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>%
group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity") +
geom_line((liquorSale %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold))), aes(group=Category.Name, x=Month, y = total_sold))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
filterData %>%
group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity") +
geom_line((liquorSale %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold))), aes(group=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
ggplot(filterData,aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name)) +
geom_line(data = temp, aesaes(group=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
ggplot(filterData,aes()) +
geom_line(data = temp, aesaes(group=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
#filterData %>%
#  group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
#    geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity") +
#    geom_line((liquorSale %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold))), aes(group=Category.Name, x=Month, y = total_sold))
ggplot(filterData,aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name))+geom_line(aes(color=Category.Name))+
geom_line(data=temp,aes(color=Category.Name))+
labs(color="Legend text")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
#filterData %>%
#  group_by(Category.Name, Month) %>% filter() %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot() +
#    geom_line(aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name),  stat="identity") +
#    geom_line((liquorSale %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold))), aes(group=Category.Name, x=Month, y = total_sold))
ggplot(filterData,aes(group=Category.Name, x=Month, y = total, color=Category.Name))+geom_line(aes(color=Category.Name))+
geom_line(data=temp,aes(color=Category.Name))+
labs(color="Legend text")
top5 = liquorSale %>% group_by(Month, Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-temp)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
top5 = liquorSale %>% group_by(Month, Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-temp)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
top5 = liquorSale %>% group_by(Category.Name, Month) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-temp)
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
filterData
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>%  head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5)) %>% summarise(total = sum(Bottles.Sold))
filterData
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
temp
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total)  %>%  head(5)
top5
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
temp
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>%  head(5)
top5
temp = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
temp
liquorSale %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity") +
geom_line(data = filterData %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(color=Category.Name, x=Month, y = total_sold))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
liquorSale %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity") +
geom_line(data = filterData %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(color=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% head(5)
top5
filterData = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold))
filterData
ggplot() +
geom_line(data= top5, aes(color=Category.Name, x=Month, y = total_sold)) +
geom_point(data= filterData, aes(group=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterData = liquorSale %>% filter(Category.Name %>% in t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
liquorSale %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity") +
geom_line(data = filterData %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(color=Category.Name, x=Month, y = total_sold))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterData = liquorSale %>% filter(Category.Name %in% t(top5))
liquorSale %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = filterData %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(color=Category.Name, x=Month, y = total_sold)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata = liquorSale %>% !filter(Category.Name %in% t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% !filter(Category.Name %in% t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% !filter(Category.Name %in% t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% !filter(Category.Name %in% t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% !filter(Category.Name %in% t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% !filter(Category.Name %in% t(top5))
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% filter(!Category.Name %in% t(top5))
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = top5 %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(color=Category.Name, x=Month, y = total_sold)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% filter(!Category.Name %in% t(top5))
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = top5 %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
liquorSale$Month = format(liquorSale$Date, '%m')
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% filter(!Category.Name %in% t(top5))
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = top5 %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = format(liquorSale$Date, '%m')
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% filter(!Category.Name %in% t(top5))
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = top5 %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c("May")) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c("May")) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c("5")) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c(5)) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c(5)) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c(5)) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c(5)) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = months(liquorSale$Date)
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c('May')) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = format(liquorSale$Date, '%m')
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% filter(!Category.Name %in% t(top5))
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = top5 %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% 5) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c('5')) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c('5')) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c('5')) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library("lobstr")
library(dplyr)
library(purrr)
library(stringr)
library(strex)
liquorSale <- read.csv('2021_Iowa_Liquor_Sales.csv')
#head(liquorSale)
liquorSale$Date = as.Date(liquorSale$Date, '%m/%d/%Y')
str(liquorSale)
# remove all non numeric values from
temp = gsub("[A-Z]", '', liquorSale$Store.Location)
# remove all ()
temp = gsub("[()]", '', temp)
#remove extra white space
temp = gsub("\\s+"," ",temp)
temp = trimws(temp)
#replace space with comma
temp = str_replace(temp, ' ', ',')
liquorSale$temp = temp
#liquorSale
liquorSale = liquorSale %>% separate(temp, c("longitude", "latitude"), sep = ',')
#liquorSale
liquorSale$longitude = as.numeric(liquorSale$longitude)
liquorSale$latitude = as.numeric(liquorSale$latitude)
str(liquorSale)
options(repr.plot.width=100, repr.plot.height=100)
liquorSale %>% group_by(Category.Name) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Day = weekdays(liquorSale$Date)
#liquorSale
liquorSale %>% group_by(Day) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Day, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
liquorSale$Month = format(liquorSale$Date, '%m')
top5 = liquorSale %>% group_by(Category.Name) %>% summarise(total = sum(Bottles.Sold)) %>% arrange(-total) %>% select(Category.Name) %>% head(5)
top5
filterdata = liquorSale %>% filter(!Category.Name %in% t(top5))
top5 = liquorSale %>% filter(Category.Name %in% t(top5))
filterdata %>%
group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)) %>%
ggplot() +
geom_line(data = top5 %>% group_by(Category.Name, Month) %>% summarise(total_sold = sum(Bottles.Sold)), aes(group=Category.Name, x=Month, y = total_sold, color=Category.Name)) +
geom_line(aes(group=Category.Name, x=Month, y = total_sold),  stat="identity")
liquorSale$Month = months(liquorSale$Date)
liquorSale %>% group_by(Category.Name) %>% filter(Month %in% c('May')) %>% summarise(total_sold = sum(Bottles.Sold)) %>% ggplot(aes(x=Category.Name, y = total_sold)) + geom_bar(stat="identity") + theme(axis.text.x = element_text(angle = 90))
setwd('E:/school/202/lab5')
knitr::opts_chunk$set(echo = TRUE)
acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
per <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
knitr::opts_chunk$set(echo = TRUE)
acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
per <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
acc
per
knitr::opts_chunk$set(echo = TRUE)
#acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
#per <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
acc <- read.csv("accident.csv", stringsAsFactors = FALSE)
per <- read.csv("person.csv", stringsAsFactors = FALSE)
acc
per
